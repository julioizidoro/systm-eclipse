<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core">
<ui:composition template="/pages/templates/default.xhtml">
	<ui:define name="corpo">
		<h:form id="consultaControleSeguro" style="font-size:11px;">
			<div id="centro">
				<p:growl id="growl" showDetail="true" sticky="false"
					life="#{aplicacaoMB.parametrosprodutos.tempomensagens}" />
				<br></br>
				<p:accordionPanel class="painel" activeIndex="-1">
					<p:tab titleStyle="color:#000;font-size:11px;background:#c7d95f;"
						title="Pesquisar">
						<h:panelGrid columns="4"
							columnClasses="tamanho7, tamanhoavisos,tamanho7, tamanho1"
							style="width:97.5%;margin-left:4%;">
							<p:outputLabel value="ID Vendas" for="idvenda" />
							<p:outputLabel value="Cliente" for="cliente" />
							<p:outputLabel value="Periodo de Início" for="dataIni" />
							<p:outputLabel />

							<p:inputText id="idvenda" value="#{controleSeguroMB.idVenda}"
								style="width:90%" />
							<p:inputText id="cliente" value="#{controleSeguroMB.nomeCliente}"
								style="width:90%" />
							<p:calendar id="dataIni" value="#{controleSeguroMB.dataInicio}"
								size="10" locale="pt" pattern="dd/MM/yyyy" mask="true"
								maxlength="15">
								<f:convertDateTime pattern="dd/MM/yyyy"
									timeZone="America/Sao_Paulo" />
								<p:ajax event="blur" />
							</p:calendar>
							<p:calendar id="dataFinal" value="#{controleSeguroMB.dataFim}"
								size="10" locale="pt" pattern="dd/MM/yyyy" mask="true"
								maxlength="15">
								<f:convertDateTime pattern="dd/MM/yyyy"
									timeZone="America/Sao_Paulo" />
								<p:ajax event="blur" />
							</p:calendar>
						</h:panelGrid>
						<br></br>
						<h:panelGrid columns="4"
							columnClasses="tamanho1,tamanho1,tamanho1, tamanho1"
							style="width:85%;margin-left:4%;">
							<p:outputLabel value="Unidade" for="unidade" />
							<p:outputLabel value="Consultor" for="consultor" />
							<p:outputLabel value="Tipo" />
							<p:outputLabel />

							<p:selectOneMenu id="unidade" filter="true"
								filterMatchMode="startsWith" panelStyle="width:180px"
								value="#{controleSeguroMB.unidadenegocio}" style="width:193px;"
								converter="UnidadeNegocioConverter">
								<f:selectItem itemLabel="Selecione" itemValue="0"
									noSelectionOption="true" />
								<f:selectItems value="#{controleSeguroMB.listaUnidadeNegocio}"
									var="unidade" itemLabel="#{unidade.nomerelatorio}"
									itemValue="#{unidade}" />
								<f:attribute name="listaUnidade"
									value="#{controleSeguroMB.listaUnidadeNegocio}" />
								<p:ajax event="change"
									listener="#{controleSeguroMB.gerarListaConsultor()}"
									update="consultor"></p:ajax>
							</p:selectOneMenu>
							<p:selectOneMenu id="consultor"
								value="#{controleSeguroMB.usuario}" style="width:150px;"
								converter="UsuarioConverter" filter="true"
								filterMatchMode="startsWith" panelStyle="width:180px">
								<f:selectItem itemLabel="Selecione" itemValue="0"
									noSelectionOption="true" />
								<f:selectItems value="#{controleSeguroMB.listaConsultor}"
									var="consultor" itemLabel="#{consultor.nome}"
									itemValue="#{consultor}" />
								<f:attribute name="listaUsuario"
									value="#{controleSeguroMB.listaConsultor}" />
							</p:selectOneMenu>
							<p:selectOneMenu id="tipo"
								value="#{controleSeguroMB.tipoEmissao}" style="width:130px;">
								<f:selectItem itemLabel="Todos" itemValue="Todos" />
								<f:selectItem itemLabel="Avulso" itemValue="Avulso" />
								<f:selectItem itemLabel="Au Pair" itemValue="Au Pair" />
								<f:selectItem itemLabel="Curso" itemValue="Curso" />
								<f:selectItem itemLabel="Demi Pair" itemValue="Demi Pair" />
								<f:selectItem itemLabel="High School" itemValue="High School" />
								<f:selectItem itemLabel="Higher Education"
									itemValue="Higher Education" />
								<f:selectItem itemLabel="Pacotes" itemValue="Pacotes" />
								<f:selectItem itemLabel="Programas Teens"
									itemValue="Programas Teens" />
								<f:selectItem itemLabel="Trainee" itemValue="Trainee" />
								<f:selectItem itemLabel="Voluntariado" itemValue="Voluntariado" />
								<f:selectItem itemLabel="Work and Travel"
									itemValue="Work and Travel" />
							</p:selectOneMenu>
							<h:panelGroup>
								<p:commandButton value="Pesquisar" icon=" ui-icon-search "
									update="consultaControleSeguro:acordionPainel"
									action="#{controleSeguroMB.pesquisar()}" />
								<p:commandButton value="Limpar" icon="ui-icon-arrowrefresh-1-w"
									update="consultaControleSeguro:acordionPainel, unidade, dataFinal, dataIni, cliente,idvenda"
									action="#{controleSeguroMB.limpar()}" />
							</h:panelGroup>
						</h:panelGrid>
					</p:tab>
				</p:accordionPanel> 
				<legend id="iUsu2">
					<b>Consulta Controle de Seguro Viagem</b>
				</legend>
				<br /> <b style="font-size: 12px; margin-left: 2.3%; color: #000;">#{controleSeguroMB.numeroDiasString}</b>
 				<b style="font-size: 12px; margin-left: 2.3%; color: #000;">#{controleSeguroMB.numeroSeguroString}</b>
				<br />  
				<p:tabView id="acordionPainel" class="consultaCurso">
					<p:tab title="Financeiro (#{controleSeguroMB.nFichasFinanceiro})"
						titleStyle="font-size:11px;">
						<p:dataTable id="tabelaFinanceiro" var="financeiro"
							value="#{controleSeguroMB.listaVendasFinanceiro}"
							scrollable="true" scrollHeight="300" style="margin-bottom:20px">
							<p:column style="width:42px;">
								<p:commandLink
									title="FINANCEIRO (FICHA EM ANÁLISE NO DEPARTAMENTO FINANCEIRO)">
									<img src="../../resources/img/ficharestricao.png" width="35" />
								</p:commandLink>       
							</p:column>   
							<p:column headerText="ID Venda" style="width:65px;">
								<h:outputText value="#{financeiro.seguroviagem.vendas.idvendas}" />
							</p:column>
							<p:column headerText="Cliente" styleClass="alinharCenter"
								style="width:140px;">
								<h:outputText
									value="#{financeiro.seguroviagem.vendas.cliente.nome}" />
							</p:column>
							<p:column headerText="Plano" styleClass="alinharCenter"
								style="width:115px;">
								<h:outputText  
									value="#{financeiro.seguroviagem.valoresseguro.plano}" />
							</p:column>
							<p:column headerText="Produto" styleClass="alinharCenter"
								style="width:110px;">   
								<h:outputText value="#{financeiro.seguroviagem.controle}" />
							</p:column>
							<p:column headerText="Valor Bruto" styleClass="alinharCenter"
								style="width:80px;text-align:right">
								<h:outputText value="#{financeiro.seguroviagem.valorSeguro}">
									<f:convertNumber pattern="##,###,###,###.##"
										minFractionDigits="2" />
								</h:outputText>
							</p:column>
							<p:column headerText="Início" style="width:90px;"
								styleClass="alinharCenter">
								<h:outputText value="#{financeiro.seguroviagem.dataInicio}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column headerText="Nº Dias"
								style="width:70px;text-align:right">
								<h:outputText value="#{financeiro.seguroviagem.numeroSemanas}" />
							</p:column>
							<p:column headerText="Fim" style="width:90px;"
								styleClass="alinharCenter">
								<h:outputText value="#{financeiro.seguroviagem.dataTermino}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column headerText="Tipo" style="width:70px;text-align:left;">
								<h:outputText value="#{controleSeguroMB.tipoSeguro(financeiro)}" />
							</p:column>
							<p:column headerText="Data Emissão" style="width:100px;"
								styleClass="alinharCenter">
								<h:outputText value="#{financeiro.dataemissao}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column style="width:70px;text-align:left;">
								<p:commandLink title="Emitir"
									actionListener="#{controleSeguroMB.buscarSeguro(financeiro)}"
									icon="ui-icon-plus"
									update=":editarData:dialog_editarDataVencimento"
									oncomplete="PF('editarData').show()" style="font-size:12px;">
									<img src="../../resources/img/confirmarBola.png"
										style="width: 46%" />
								</p:commandLink>
								<p:commandLink
									action="#{controleSeguroMB.cancelarVenda(financeiro)}"
									style="text-decoration: none" title="Cancelar Ficha"
									update="tabelaFinanceiro">
									<img src="../../resources/img/cancel.png" style="width: 46%" />
									<p:ajax event="dialogReturn"
										listener="#{controleSeguroMB.listaControleSeguro}"
										process="@this" update="tabelaFinanceiro" />
								</p:commandLink>
							</p:column>
						</p:dataTable>
					</p:tab>
					<p:tab title="Andamento (#{controleSeguroMB.nFichasAndamento})"
						titleStyle="font-size:11px;">
						<p:dataTable id="tabelaAndamento" var="andamento"
							value="#{controleSeguroMB.listaVendasAndamento}"
							scrollable="true" scrollHeight="300" style="margin-bottom:20px">
							<p:column style="width:42px;">
								<p:commandLink
									title="ANDAMENTO (FICHA AGUARDANDO UPLOAD DOS DOCUMENTOS)">
									<img src="../../resources/img/amarelaFicha.png" width="35" />
								</p:commandLink>
							</p:column>
							<p:column headerText="ID venda" style="width:70px;">
								<h:outputText value="#{andamento.seguroviagem.vendas.idvendas}" />
							</p:column>
							<p:column headerText="Cliente" styleClass="alinharCenter"
								style="width:140px;">
								<h:outputText
									value="#{andamento.seguroviagem.vendas.cliente.nome}" />
							</p:column>
							<p:column headerText="Plano" styleClass="alinharCenter"
								style="width:120px;">
								<h:outputText
									value="#{andamento.seguroviagem.valoresseguro.plano}" />
							</p:column>
							<p:column headerText="Produto" styleClass="alinharCenter"
								style="width:110px;">
								<h:outputText value="#{andamento.seguroviagem.controle}" />
							</p:column>
							<p:column headerText="Valor Bruto" styleClass="alinharCenter"
								style="width:80px;text-align:right">
								<h:outputText value="#{andamento.seguroviagem.valorSeguro}">  
									<f:convertNumber pattern="##,###,###,###.##"
										minFractionDigits="2" />
								</h:outputText>
							</p:column>
							<p:column headerText="Início" style="width:90px;"
								styleClass="alinharCenter">
								<h:outputText value="#{andamento.seguroviagem.dataInicio}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column headerText="Nº Dias"
								style="width:70px;text-align:right">
								<h:outputText value="#{andamento.seguroviagem.numeroSemanas}" />
							</p:column>
							<p:column headerText="Fim" style="width:90px;"
								styleClass="alinharCenter">
								<h:outputText value="#{andamento.seguroviagem.dataTermino}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column headerText="Tipo" style="width:70px;text-align:left;">
								<h:outputText value="#{controleSeguroMB.tipoSeguro(andamento)}" />
							</p:column>
							<p:column headerText="Data Emissão" style="width:100px;"
								styleClass="alinharCenter">
								<h:outputText value="#{andamento.dataemissao}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column style="width:70px;text-align:left;">
								<p:commandLink title="Emitir"
									actionListener="#{controleSeguroMB.buscarSeguro(andamento)}"
									icon="ui-icon-plus"
									update=":editarData:dialog_editarDataVencimento"
									oncomplete="PF('editarData').show()" style="font-size:12px;">
									<img src="../../resources/img/confirmarBola.png"
										style="width: 46%" />
								</p:commandLink>
								<p:commandLink
									action="#{controleSeguroMB.cancelarVenda(andamento)}"
									style="text-decoration: none" title="Cancelar Ficha"
									update="tabelaAndamento">
									<img src="../../resources/img/cancel.png" style="width: 46%" />
									<p:ajax event="dialogReturn"
										listener="#{controleSeguroMB.listaControleSeguro}"
										process="@this" update="tabelaAndamento" />
								</p:commandLink>
							</p:column>
						</p:dataTable>
					</p:tab>
					<p:tab title="Finalizado (#{controleSeguroMB.nFichasFinanceiro})"
						titleStyle="font-size:11px;">
						<p:dataTable id="tabelaFinalizado" var="finalizado"
							value="#{controleSeguroMB.listaVendasFinalizada}"
							scrollable="true" scrollHeight="300" style="margin-bottom:20px">
							<p:column style="width:42px;">
								<p:commandLink title="FICHA FINALIZADA">
									<img src="../../resources/img/finalizadoFicha.png" width="35" />
								</p:commandLink>
							</p:column>
							<p:column headerText="ID venda" style="width:70px;">
								<h:outputText value="#{finalizado.seguroviagem.vendas.idvendas}" />
							</p:column>
							<p:column headerText="Cliente" styleClass="alinharCenter"
								style="width:140px;">
								<h:outputText
									value="#{finalizado.seguroviagem.vendas.cliente.nome}" />
							</p:column>
							<p:column headerText="Plano" styleClass="alinharCenter"
								style="width:120px;">    
								<h:outputText
									value="#{finalizado.seguroviagem.valoresseguro.plano}" />
							</p:column>
							<p:column headerText="Produto" styleClass="alinharCenter"
								style="width:110px;">
								<h:outputText value="#{finalizado.seguroviagem.controle}" />
							</p:column>
							<p:column headerText="Valor Bruto" styleClass="alinharCenter"
								style="width:80px;text-align:right">
								<h:outputText value="#{finalizado.seguroviagem.valorSeguro}">
									<f:convertNumber pattern="##,###,###,###.##"
										minFractionDigits="2" />
								</h:outputText>
							</p:column>
							<p:column headerText="Início" style="width:90px;"
								styleClass="alinharCenter">
								<h:outputText value="#{finalizado.seguroviagem.dataInicio}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column headerText="Nº Dias"
								style="width:70px;text-align:right">
								<h:outputText value="#{finalizado.seguroviagem.numeroSemanas}" />
							</p:column>
							<p:column headerText="Fim" style="width:90px;"
								styleClass="alinharCenter">
								<h:outputText value="#{finalizado.seguroviagem.dataTermino}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column headerText="Tipo" style="width:70px;text-align:left;">
								<h:outputText value="#{controleSeguroMB.tipoSeguro(finalizado)}" />
							</p:column>
							<p:column headerText="Data Emissão" style="width:100px;"
								styleClass="alinharCenter">
								<h:outputText value="#{finalizado.dataemissao}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column style="width:70px;text-align:left;">
								<p:commandLink title="Emitir"
									actionListener="#{controleSeguroMB.buscarSeguro(finalizado)}"
									icon="ui-icon-plus"
									update=":editarData:dialog_editarDataVencimento"
									oncomplete="PF('editarData').show()" style="font-size:12px;">
									<img src="../../resources/img/confirmarBola.png"
										style="width: 46%" />
								</p:commandLink>
								<p:commandLink
									action="#{controleSeguroMB.cancelarVenda(finalizado)}"
									style="text-decoration: none" title="Cancelar Ficha"
									update="tabelaFinalizado">
									<img src="../../resources/img/cancel.png" style="width: 46%" />
									<p:ajax event="dialogReturn"
										listener="#{controleSeguroMB.listaControleSeguro}"
										process="@this" update="tabelaFinalizado" />
								</p:commandLink>
							</p:column>
						</p:dataTable>
					</p:tab>
					<p:tab title="Cancelado (#{controleSeguroMB.nFichaCancelada})"
						titleStyle="font-size:11px;">
						<p:dataTable id="tabelaCancelado" var="cancelado"
							value="#{controleSeguroMB.listaVendasCancelada}"
							scrollable="true" scrollHeight="300" style="margin-bottom:20px">
							<p:column style="width:42px;">
								<p:commandLink title="FICHA CANCELADA">
									<img src="../../resources/img/fichaCancelada.png" width="35" />
								</p:commandLink>
							</p:column>
							<p:column headerText="ID venda" style="width:80px;">
								<h:outputText value="#{cancelado.seguroviagem.vendas.idvendas}" />
							</p:column>
							<p:column headerText="Cliente" styleClass="alinharCenter"
								style="width:140px;">
								<h:outputText
									value="#{cancelado.seguroviagem.vendas.cliente.nome}" />
							</p:column>
							<p:column headerText="Plano" styleClass="alinharCenter"
								style="width:120px;">
								<h:outputText
									value="#{cancelado.seguroviagem.valoresseguro.plano}" />
							</p:column>
							<p:column headerText="Produto" styleClass="alinharCenter"
								style="width:120px;">
								<h:outputText value="#{cancelado.seguroviagem.controle}" />
							</p:column>
							<p:column headerText="Valor Bruto" styleClass="alinharCenter"
								style="width:80px;text-align:right">
								<h:outputText value="#{cancelado.seguroviagem.valorSeguro}">
									<f:convertNumber pattern="##,###,###,###.##"
										minFractionDigits="2" />
								</h:outputText>
							</p:column>
							<p:column headerText="Início" style="width:90px;"
								styleClass="alinharCenter">
								<h:outputText value="#{cancelado.seguroviagem.dataInicio}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column headerText="Nº Dias"
								style="width:70px;text-align:right">
								<h:outputText value="#{cancelado.seguroviagem.numeroSemanas}" />
							</p:column>
							<p:column headerText="Fim" style="width:90px;"
								styleClass="alinharCenter">
								<h:outputText value="#{cancelado.seguroviagem.dataTermino}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column headerText="Tipo" style="width:70px;text-align:left;">
								<h:outputText value="#{controleSeguroMB.tipoSeguro(cancelado)}" />
							</p:column>
							<p:column headerText="Data Emissão" style="width:100px;"
								styleClass="alinharCenter">
								<h:outputText value="#{cancelado.dataemissao}">
									<f:convertDateTime pattern="dd/MM/yyyy"
										timeZone="America/Sao_Paulo" />
								</h:outputText>
							</p:column>
							<p:column style="width:70px;text-align:left;">
								<p:commandLink title="Emitir"
									actionListener="#{controleSeguroMB.buscarSeguro(cancelado)}"
									icon="ui-icon-plus"
									update=":editarData:dialog_editarDataVencimento"
									oncomplete="PF('editarData').show()" style="font-size:12px;">
									<img src="../../resources/img/confirmarBola.png"
										style="width: 46%" />
								</p:commandLink>
								<p:commandLink
									action="#{controleSeguroMB.cancelarVenda(cancelado)}"
									style="text-decoration: none" title="Cancelar Ficha"
									update="tabelaCancelado">
									<img src="../../resources/img/cancel.png" style="width: 46%" />
									<p:ajax event="dialogReturn"
										listener="#{controleSeguroMB.listaControleSeguro}"
										process="@this" update="tabelaCancelado" />
								</p:commandLink>
							</p:column>
						</p:dataTable>
					</p:tab>
				</p:tabView>
				<br></br> <br></br>
			</div>
		</h:form>
		<h:form id="editarData">
			<p:dialog id="dialog_editarDataVencimento" header="Editar Data"
				widgetVar="editarData" width="20%"
				style="background:#d0e9c6;text-align: left">
				<p:outputLabel value="Data de Vencimento" for="dataVencimento"
					style="font-size: 11px" />
				<br></br>
				<p:calendar id="dataVencimento" class="fontebranca"
					value="#{controleSeguroMB.dataEmissao}" pattern="dd/MM/yyyy"
					mask="true" maxlength="15" locale="pt">
					<f:convertDateTime timeZone="America/Sao_Paulo" />
					<p:ajax event="change" />
					<p:ajax event="dateSelect" />
				</p:calendar>
				<p:commandButton value="Salvar" icon="ui-icon-check"
					action="#{controleSeguroMB.emitirSeguro()}"
					class="espacocobranca23botao" style="font-size:11px;" update="@all"
					onclick="editarData.hide()" />
			</p:dialog>
		</h:form>
	</ui:define>
</ui:composition>
</html>